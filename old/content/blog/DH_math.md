---
title: "Groups and Subgroups while using DH"
created_at: 2013-09-01 09:35:01 +0000
auteur: "Sander Demeester"
kind: article
img: "/img/4.jpg"
---
### Group and Subgroups###

For the rest of the text, we 
Voor de rest van deze tekst, consider \\(p\\) as a big prime number (order 2000 - 4000 bits). Most of our calculations will be mod \\(p\\).
the DH protocol uses \\(Z^{*}_{p} \\), multiplication group mod \\(\p\\)

Choose a \\(\g\\) in that group and consider the numbers:
<notextile>
$$
	1,g,g^{2},g^{3},\cdots,
$$
</notextile>

All mod \\(p\\). This is an infinite series in \\(Z^{\*}\_{p} \\) (Remeber that \\(Z^{\*}_{p} \\) the numbers \\(1,2,\cdots,p-1\\) includes the multiplication modulo operation.
\\(p\\) ).

There is a moment when the numbers start to repat. <br>

We make the assumption that this happened at \\(g^{i} = g^{j}\\) waar \\(i < j\\). 

We can perform a division mod \\(p\\) on both numbers. We devide each side by \\(g^{i}\\) and get 
\\(1 = g^{j-i}\\). 
To say it differently, there exists a number \\(q = j-i\\) so that \\(g^q = 1 \text{ mod } p\\). We call this smallest value for \\(q\\) the order of \\(g\\).

If we continue to multiply \\(g\\) we will obtain the series:
<notextile>
$$
1,g,g^{2},\cdots,g^{q-1}
$$
</notextile>
After which we return at  \\(g^{q} = 1\\) and the series starts to repeat itself. We say that \\(g\\) is a generator for the collection \\(1,g,g^{2},\cdots,g^{q-1}\\). The number of elements that we can write as a power of \\(g\\) is \\(q\\), the order of \\(g\\).

One of the properties of multiplicative modulo \\(p\\) is that there exists at least one value for \\(g\\) that will generate the entire group, what we means is that for the value \\(g\\) there exists  \\(q = p -1 \\). 
So instead of viewing the numbers \\(1,\cdots,p-1\\) in \\( Z^{\*}\_{p} \\), we can also view them as:
<notextile>
$$
	1,g,g^{2},\cdots,g^{p-2}
$$
</notextile>

A \\(g\\) that generates the entire is called a premitive element. Other values for \\(g\\) can generate smaller sets.<br>
We observe that if we take two numbers from the serie generated by a \\(g\\) we again, get a power of \\(g\\) that is also an element from that same series. All elements from that group again form a group, we call these groups subgroups.

For each element \\(g\\) it holds that the order of \\(g\\) is a devider of \\(p-1\\). It is trivial to demonstrate that this is true. Choose a premetive element \\(g\\). Let \\(h\\) be each other element. Because \\(g\\) is a generated for the whole group, there will be a \\(x\\) so that \\(\h = g^{x}\\). Consider the elements generated by \\(h\\). Those are:
<notextile>
$$
1,h,h^{2},h^{3},\cdots
$$
</notextile>
Dit is het zelfde als:
<notextile>
$$
1,g^{x},g^{2x},g^{3x},\cdots, 
$$
</notextile>
(All calculations are still mod \\(p\\). )
The order of \\(h\\) is the smallest \\(q\\) so that \\(h^{q} = 1\\).<br>

This is the same as saying that it is a \\(\q\\) so that \\(g^{xq} = 1\\) for every \\(t\\), \\(g^{t} = 1\\). <br>
This is the same as saying that \\(t = 0 (\text{mod }p-1)\\). So \\(q\\) is the smallest \\(q\\) so that \\(xq = 0 (\text{ mod }p-1)\\). <br>
This happens when
<notextile>
$$
q = \frac{p-1}{gcd(x,p-1)}
$$
</notextile>
So \\(q\\) is clearly a factor of \\(p-1\\).

A simpel example:
We choose \\(p = 7\\), and we let \\(g = 3\\). So \\(g\\) is a premetive element because: 
<notextile>
$$
1,g,g^{2},g^{3},\cdots,g^{5} = 1,3,2,6,4,5
$$
</notextile>
(All calclulations are mod 7).
We choose \\(h = 2\\), \\(h\\) generates the following subgroup:
<notextile>
$$
1,h,h^{2} = 1,2,4.
$$
</notextile>
Becuase  \\(h^{3} = 2^{3} (\text{mod } 7) = 1\\). The element \\(h = 6\\) generates the subgroup \\(1,6\\). These subgroups have a length of 2 and 3. Both are deviders of  \\(p-1\\). 
We can demonstrate this by using the fermat test. Based on the fact that for every \\(a\\) holds that \\(a^{p-1} = 1\\). This is trivial to demonstrate. Let \\(g\\) be a generated for \\(Z^{\*}\_{p}\\) and choose \\(x\\) so that \\(g^{x} = a\\). \\(g\\) is a generator for the whole group, there always exists such an \\(x\\). But now the followig holds to be true.
<notextile>
$$
a^{p-1} = g^{x(p-1)} = (g^{p-1})^{x} = 1^{x} = 1
$$
</notextile>

### Diffie-Hellman Basis###
For the original DH protocol we need a big prime number \\(p\\), and a premetive element \\(g\\) that generates the whole group \\(Z^{\*}\_{p}\\).
(\\(p,g\\)) are the public constants. We make the assumtion that all entities (including our attacker) has knowledge about these values.<br>
The protocol is executed in the following manner:
- Alice chooses a random value \\(x \in Z^{\*}\_{p} \\).<br>
  She calculates \\(g^{x} \text{ mod } p\\) and sends it to Bob.<br>
- Bob chooses a random \\(y \in Z^{\*}\_{p} \\).<br>
  And he calculates \\(g^{y} \text{ mod } p\\) and sends this to Alice.<br>
- The final result for both Alice and Bob is \\(k = g^{yx}\\).<br>
<br>
Alice is able to calculated the exponentiation \\(g^{x}\\) with the value that she received from Bob.
<notextile>
$$
(g^{y})^{x} = g^{xy}
$$
</notextile>
Bob can perform the same calculation in a similar fashion. But what can the attacker do?
The attacker sees the value (\\(g^{x} \text{ mod } p,g^{y} \text{ mod } p\\)), but not the values (\\(x,y\\)). <br>
Finding \\(g^{xy}\\) with only having knowledge of \\(g^{x} \text{ mod }p,g^{y} \text{mod p }\\) is called the Diffie-Hellman problem.<br>
As long as (\\(g,p\\)) are chosen correctly there is no way for the attacker to find \\(g^{xy}\\) in a timely fashion.
